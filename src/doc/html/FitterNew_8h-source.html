<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wuparam: FitterNew.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>FitterNew.h</h1><div class="fragment"><pre>00001 <span class="comment">// Fitter.h</span>
00002 <span class="comment">// Henric Krawczynski &lt;krawcz@wuphys.wustl.edu&gt;</span>
00003 
00004 <span class="preprocessor">#ifndef FITTER_H</span>
00005 <span class="preprocessor"></span><span class="preprocessor">#define FITTER_H</span>
00006 <span class="preprocessor"></span>
00007 <span class="comment">//</span>
00008 <span class="comment">// SPECTRAL FITTING PACKAGE</span>
00009 <span class="comment">//</span>
00010 
00011 <span class="preprocessor">#include &lt;vector&gt;</span>
00012 <span class="preprocessor">#include "Histogram.h"</span>
00013 <span class="preprocessor">#include "Config.h"</span>
00014 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00015 
00016 
00021 <span class="keyword">struct </span><a class="code" href="structMCRecord.html">MCRecord</a> {
00022     <span class="keywordtype">double</span> trueEnergy_in_TeV;
00023     <span class="keywordtype">double</span> estimatedEnergy;
00024 };
00025 
00026 
00031 <span class="keyword">struct </span><a class="code" href="structData.html">Data</a>{
00032     <span class="keywordtype">double</span> onOff,onOffVariance;
00033 };
00034 
00038 <span class="keyword">struct </span><a class="code" href="structResults.html">Results</a> {
00039     <span class="keywordtype">double</span> chiSquare;
00040     <span class="keywordtype">int</span>    dof;
00041     <span class="keywordtype">double</span> n0,n0P,n0M;
00042     <span class="keywordtype">double</span> gamma0,gammaP,gammaM;
00043     <span class="keywordtype">double</span> e0,e0P,e0M;
00044 };
00045 
00046 <span class="keyword">struct </span>MCBinInfo {
00047 
00048     <span class="keywordtype">double</span> start;
00049     <span class="keywordtype">double</span> end;
00050     <span class="keywordtype">double</span> radius;
00051     <span class="keywordtype">int</span> nummc;
00052 
00053 };
00054 
00067 <span class="keyword">class </span><a class="code" href="classMCSpectrum.html">MCSpectrum</a> {
00068 
00069  <span class="keyword">public</span>:
00070 
00071     <a class="code" href="classMCSpectrum.html#a0">MCSpectrum</a>( <a class="code" href="classRunInfo.html">RunInfo</a> &amp;ri );
00072     ~<a class="code" href="classMCSpectrum.html">MCSpectrum</a>();
00073     
00074     <span class="keywordtype">void</span> <a class="code" href="classMCSpectrum.html#a2">fill</a>(<span class="keywordtype">double</span> N0, <span class="keywordtype">double</span> Gamma0, <span class="keywordtype">double</span> E0, <span class="keywordtype">double</span> Time);
00075 
00076 
00077     <span class="comment">// uses class-histogram _spectrum and pointer to the experimental data</span>
00078     <span class="comment">// to determine chi-square value</span>
00079     <span class="keywordtype">double</span> <a class="code" href="classMCSpectrum.html#a3">chiSquare</a>(std::vector&lt;Data&gt; &amp;);
00080     
00081     <span class="keyword">inline</span> <span class="keywordtype">int</span>    <a class="code" href="classMCSpectrum.html#a4">dof</a>();
00082     
00083     <span class="keywordtype">double</span> <a class="code" href="classMCSpectrum.html#a5">get</a>(<span class="keywordtype">int</span>);
00084     <span class="keywordtype">void</span>   <a class="code" href="classMCSpectrum.html#a6">getRange</a>( <span class="keywordtype">int</span> bin, <span class="keywordtype">double</span> &amp;lower, <span class="keywordtype">double</span> &amp;upper );
00085     
00086     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> NUMMCBINS=9;
00087 
00088     <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* getSpectrum() { <span class="keywordflow">return</span> _spectrum; }
00089 
00090  <span class="keyword">private</span>:
00091 
00092     <span class="keywordtype">double</span> weight(<span class="keywordtype">double</span> energy, <span class="keywordtype">double</span> N0, <span class="keywordtype">double</span> Gamma0, 
00093                   <span class="keywordtype">double</span> E0, <span class="keywordtype">double</span> Time);
00094     
00095     <span class="keywordtype">void</span>   info  ( <span class="keywordtype">double</span> energy,
00096                   <span class="keywordtype">double</span> &amp;numShower, <span class="keywordtype">double</span> &amp;de, <span class="keywordtype">double</span> &amp;a, 
00097                   <span class="keywordtype">double</span> &amp;e1, <span class="keywordtype">double</span> &amp;e2);
00098     
00099 
00100     std::vector&lt;MCRecord&gt; _event;
00101 
00102     <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* _spectrum;     <span class="comment">//  histogram that holds</span>
00103                                    <span class="comment">// "artificial" energy spectrum</span>
00104 
00105     
00106     std::string _dbfilename;
00107     
00108     <span class="comment">// Class-variable holding the degrees of freedom of the fit</span>
00109     <span class="comment">// (depends on # of bins, and on event statistics)</span>
00110     <span class="keywordtype">int</span> _ndof;
00111 
00112     std::vector&lt;MCBinInfo&gt; _info;
00113 
00114 };   
00115 
00120 <span class="keywordtype">int</span> 
00121 <a class="code" href="classMCSpectrum.html#a4">MCSpectrum::dof</a>() {
00122     <span class="keywordflow">return</span> _ndof;
00123 }
00124 
00128 <span class="keyword">inline</span> <span class="keywordtype">double</span> 
00129 <a class="code" href="classMCSpectrum.html#a5">MCSpectrum::get</a>(<span class="keywordtype">int</span> i) {
00130     <span class="keywordflow">return</span> _spectrum-&gt;<a class="code" href="classHistogram.html#a21">get</a>(i);
00131 }
00132 
00136 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
00137 <a class="code" href="classMCSpectrum.html#a6">MCSpectrum::getRange</a>( <span class="keywordtype">int</span> bin, <span class="keywordtype">double</span> &amp;lower, <span class="keywordtype">double</span> &amp;upper ) {
00138   _spectrum-&gt;<a class="code" href="classHistogram.html#a9">getRange</a>(bin,lower,upper);
00139 }
00140 
00144 <span class="keyword">class </span><a class="code" href="classFitter.html">Fitter</a> {
00145 
00146  <span class="keyword">public</span>:
00147     <a class="code" href="classFitter.html">Fitter</a>( <a class="code" href="classRunInfo.html">RunInfo</a> &amp;ri ){
00148 
00149         _mcSpectrum = <span class="keyword">new</span> <a class="code" href="classMCSpectrum.html">MCSpectrum</a>( ri );
00150 
00151     }
00152     ~<a class="code" href="classFitter.html">Fitter</a>(){;}
00153     
00154     <span class="comment">//</span>
00155     <span class="comment">// Start Actual Fitting Process</span>
00156     <span class="comment">// Save Chi-Square Table in File "Totals/chi.text"</span>
00157     <span class="comment">//</span>
00158     <span class="keywordtype">void</span> <a class="code" href="classFitter.html#a2">minimize</a>( <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* energy_on,<a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* energy_off, 
00159                    <span class="keywordtype">double</span> &amp;N0, <span class="keywordtype">double</span> &amp;Gamma0, <span class="keywordtype">double</span> &amp;E0, <span class="keywordtype">double</span> Time, 
00160                    <span class="keywordtype">double</span> n0Range, <span class="keywordtype">int</span> n0Step, 
00161                    <span class="keywordtype">double</span> gRange, <span class="keywordtype">int</span> gStep,
00162                    <span class="keywordtype">double</span> e0Range, <span class="keywordtype">double</span> e0Step, 
00163                    <span class="keywordtype">double</span> onoffratio);
00164     
00165     <span class="comment">//</span>
00166     <span class="comment">// Print Out Results and Save Reconstructed Energy Spectra in</span>
00167     <span class="comment">// "Totals/espectrum.text"</span>
00168     <span class="comment">//</span>
00169     <span class="keywordtype">void</span>   <a class="code" href="classFitter.html#a3">save</a>();
00170     
00171  <span class="keyword">private</span>:
00172     <span class="comment">// Object that takes care of the MC data</span>
00173     <a class="code" href="classMCSpectrum.html">MCSpectrum</a> *_mcSpectrum;
00174     
00175     <span class="comment">// Array with experimental data</span>
00176     std::vector&lt;Data&gt;  _data;
00177     
00178     <span class="comment">// Results of chi-square fit</span>
00179     <a class="code" href="structResults.html">Results</a>    _results;
00180 };
00181 
00182 <span class="preprocessor">#endif</span>
00183 <span class="preprocessor"></span>    
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Apr 21 10:22:45 2007 for wuparam by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
