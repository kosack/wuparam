<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wuparam: SuperCutter.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>SuperCutter.cpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include "ImageAnalyzer.h"</span>
00002 <span class="preprocessor">#include "SuperCutter.h"</span>
00003 <span class="preprocessor">#include "ZCutter.h"</span>
00004 <span class="preprocessor">#include "EZCutter.h"</span>
00005 <span class="preprocessor">#include "SpectralCutter.h"</span>
00006 <span class="preprocessor">#include "Exceptions.h"</span>
00007 
00008 
00027 <span class="keywordtype">bool</span>
<a name="l00028"></a><a class="code" href="classSuperCutter.html#a2">00028</a> <a class="code" href="classSuperCutter.html#a2">SuperCutter::pass</a>( <a class="code" href="structHillasParameterization.html">HillasParameterization</a> &amp;param, <span class="keywordtype">int</span> cutmask ) {
00029 
00030     <span class="keywordtype">bool</span> passed=<span class="keyword">true</span>;
00031 
00032     <span class="comment">// check for invalid event</span>
00033 
00034     <span class="keywordflow">if</span> (param.<a class="code" href="structImageParameterization.html#o4">invalid</a> &gt; 0)
00035         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00036 
00037     <span class="comment">// process cutmask:</span>
00038 
00039     <span class="keywordflow">if</span> ( cutmask &amp; Cuts::SIZE ) {
00040         passed &amp;= passSize(param);
00041     } 
00042     
00043     <span class="keywordflow">if</span> (cutmask &amp; Cuts::MAX ) {
00044         passed &amp;= passMax(param);
00045     }
00046     
00047     <span class="keywordflow">if</span> (cutmask &amp; Cuts::FRAC ) {
00048         passed &amp;= passFrac(param);
00049     }
00050 
00051     <span class="keywordflow">if</span> (cutmask &amp; Cuts::LENSIZE ) {
00052         passed &amp;= passLensize(param);
00053     }
00054 
00055     <span class="keywordflow">if</span> (cutmask &amp; Cuts::DISTANCE ) {
00056         passed &amp;= passDistance(param);
00057     }
00058 
00059     <span class="keywordflow">if</span> (cutmask &amp; Cuts::LENGTH ) {
00060         passed &amp;= passLength(param);
00061     }
00062 
00063     <span class="keywordflow">if</span> (cutmask &amp; Cuts::WIDTH ) {
00064         passed &amp;= passWidth(param);
00065     }
00066 
00067     <span class="keywordflow">if</span> (cutmask &amp; Cuts::ALPHA ) {
00068         passed &amp;= passAlpha(param);
00069     }
00070 
00071     <span class="keywordflow">if</span> (cutmask &amp; Cuts::ASYMM ) {
00072         passed &amp;= passAsymm(param);
00073     }
00074 
00075     <span class="keywordflow">return</span> passed;
00076 
00077 }
00078 
00079 
00080 
00085 <span class="keywordtype">void</span>
00086 <a class="code" href="classSuperCutter.html#a1">SuperCutter::</a>
<a name="l00087"></a><a class="code" href="classSuperCutter.html#a1">00087</a> <a class="code" href="classSuperCutter.html#a1">applyCorrections</a>( <a class="code" href="structHillasParameterization.html">HillasParameterization</a> &amp;param ) {
00088 
00089     <a class="code" href="structCoordinate__t.html">Coordinate_t</a> oa, ob; <span class="comment">// two points of origin</span>
00090     <span class="keywordtype">double</span> elong;   <span class="comment">// for elongation correction later...</span>
00091 
00092     elong = _cuts.<a class="code" href="structCutInfo.html#o1">elongation</a>; <span class="comment">// use elong from conf file </span>
00093 
00094     <span class="comment">// should be same as used in ImageAnalyzer:    </span>
00095     <span class="keyword">const</span> <span class="keywordtype">double</span> NOMINAL_ELONGATION = 1.68; 
00096 
00097     <span class="comment">// re-correct the point of origin for the specified elongation</span>
00098     <span class="comment">// factor.  Why? so optimization of cut parameters is faster! It's</span>
00099     <span class="comment">// much harder to optimize elongation when you have to</span>
00100     <span class="comment">// re-parameterize every time - much quicker to do it here.</span>
00101     
00102     oa.<a class="code" href="structCoordinate__t.html#o0">x</a> = (param.<a class="code" href="structHillasParameterization.html#o1">point_of_origin_a</a>.<a class="code" href="structCoordinate__t.html#o0">x</a> - param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o0">x</a>)
00103         * elong/NOMINAL_ELONGATION + param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o0">x</a>;
00104     oa.<a class="code" href="structCoordinate__t.html#o1">y</a> = (param.<a class="code" href="structHillasParameterization.html#o1">point_of_origin_a</a>.<a class="code" href="structCoordinate__t.html#o1">y</a> - param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o1">y</a>)
00105         * elong/NOMINAL_ELONGATION + param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o1">y</a>;
00106     
00107     ob.<a class="code" href="structCoordinate__t.html#o0">x</a> = (param.<a class="code" href="structHillasParameterization.html#o2">point_of_origin_b</a>.<a class="code" href="structCoordinate__t.html#o0">x</a> - param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o0">x</a>)
00108         * elong/NOMINAL_ELONGATION + param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o0">x</a>;
00109     ob.<a class="code" href="structCoordinate__t.html#o1">y</a> = (param.<a class="code" href="structHillasParameterization.html#o2">point_of_origin_b</a>.<a class="code" href="structCoordinate__t.html#o1">y</a> - param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o1">y</a>)
00110         * elong/NOMINAL_ELONGATION + param.<a class="code" href="structHillasParameterization.html#o0">centroid</a>.<a class="code" href="structCoordinate__t.html#o1">y</a>;
00111     
00112     param.<a class="code" href="structHillasParameterization.html#o1">point_of_origin_a</a> = oa;
00113     param.<a class="code" href="structHillasParameterization.html#o2">point_of_origin_b</a> = ob;
00114     
00115 }
00116 
00117 
00118 <a class="code" href="classCutFactory.html">CutFactory</a>* CutFactory::pinstance = NULL;
00119 
00123 <a class="code" href="classCutFactory.html">CutFactory</a>* 
00124 <a class="code" href="classCutFactory.html#e0">CutFactory::</a>
<a name="l00125"></a><a class="code" href="classCutFactory.html#e0">00125</a> <a class="code" href="classCutFactory.html#e0">instance</a>() {
00126 
00127     <span class="keywordflow">if</span> (pinstance == NULL)
00128         pinstance = <span class="keyword">new</span> <a class="code" href="classCutFactory.html">CutFactory</a>();
00129     
00130     <span class="keywordflow">return</span> pinstance;
00131 
00132 }
00133 
00134 CutFactory::CutFactory(){ }
00135 
00136 <a class="code" href="classSuperCutter.html">SuperCutter</a>*
00137 CutFactory::newCutter( <span class="keyword">const</span> <a class="code" href="classRunInfo.html">RunInfo</a> &amp;ri ) {
00138 
00139     <a class="code" href="classSuperCutter.html">SuperCutter</a> *cutter;
00140     
00141     <span class="keywordflow">switch</span> (ri.<a class="code" href="classRunInfo.html#o24">cuttype</a>) {
00142     <span class="keywordflow">case</span> Config::SUPERCUTTER:
00143         cutter = <span class="keyword">new</span> <a class="code" href="classSuperCutter.html">SuperCutter</a>();
00144         <span class="keywordflow">break</span>;
00145     <span class="keywordflow">case</span> Config::ZCUTTER:
00146         cutter = <span class="keyword">new</span> <a class="code" href="classZCutter.html">ZCutter</a>();
00147         <span class="keywordflow">break</span>;
00148     <span class="keywordflow">case</span> Config::SPECTRALCUTTER:
00149         cutter = <span class="keyword">new</span> <a class="code" href="classSpectralCutter.html">SpectralCutter</a>();
00150         <span class="keywordflow">break</span>;
00151     <span class="keywordflow">case</span> Config::EZCUTTER:
00152         cutter = <span class="keyword">new</span> <a class="code" href="classEZCutter.html">EZCutter</a>();
00153         <span class="keywordflow">break</span>;
00154     <span class="keywordflow">default</span>:
00155         <span class="keywordflow">throw</span> <a class="code" href="classCriticalAnalysisException.html">CriticalAnalysisException</a>(<span class="stringliteral">"Unknown Cutter type specified"</span>);
00156         <span class="keywordflow">break</span>;
00157     }
00158 
00159     <span class="keywordflow">return</span> cutter;
00160 
00161 }
00162 
00163 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Apr 21 10:22:46 2007 for wuparam by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
