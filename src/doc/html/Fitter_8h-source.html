<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wuparam: Fitter.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>Fitter.h</h1><div class="fragment"><pre>00001 <span class="comment">// Fitter.h</span>
00002 <span class="comment">// Henric Krawczynski &lt;krawcz@wuphys.wustl.edu&gt;</span>
00003 <span class="comment">// Modifications by Karl Kosack &lt;kosack@hbar.wustl.edu&gt;</span>
00004 <span class="comment">//</span>
00005 
00033 <span class="preprocessor">#ifndef FITTER_H</span>
00034 <span class="preprocessor"></span><span class="preprocessor">#define FITTER_H</span>
00035 <span class="preprocessor"></span>
00036 <span class="comment">//</span>
00037 <span class="comment">// SPECTRAL FITTING PACKAGE</span>
00038 <span class="comment">//</span>
00039 
00040 <span class="preprocessor">#include &lt;vector&gt;</span>
00041 <span class="preprocessor">#include "Histogram.h"</span>
00042 <span class="preprocessor">#include "Config.h"</span>
00043 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00044 
00045 
<a name="l00050"></a><a class="code" href="structMCRecord.html">00050</a> <span class="keyword">struct </span><a class="code" href="structMCRecord.html">MCRecord</a> {
00051     <span class="keywordtype">double</span> trueEnergy_in_TeV;
00052     <span class="keywordtype">double</span> estimatedEnergy;
00053 };
00054 
00055 
<a name="l00060"></a><a class="code" href="structData.html">00060</a> <span class="keyword">struct </span><a class="code" href="structData.html">Data</a>{
00061     <span class="keywordtype">double</span> onOff,onOffVariance;
00062 };
00063 
<a name="l00067"></a><a class="code" href="structResults.html">00067</a> <span class="keyword">struct </span><a class="code" href="structResults.html">Results</a> {
00068     <span class="keywordtype">double</span> chiSquare;
00069     <span class="keywordtype">int</span>    dof;
00070     <span class="keywordtype">double</span> n0,n0P,n0M;
00071     <span class="keywordtype">double</span> gamma0,gammaP,gammaM;
00072     <span class="keywordtype">double</span> e0;
00073 };
00074 
00075 <span class="keyword">struct </span>MCBinInfo {
00076 
00077     <span class="keywordtype">double</span> start;
00078     <span class="keywordtype">double</span> end;
00079     <span class="keywordtype">double</span> radius;
00080     <span class="keywordtype">int</span> nummc;
00081 
00082 };
00083 
<a name="l00096"></a><a class="code" href="classMCSpectrum.html">00096</a> <span class="keyword">class </span><a class="code" href="classMCSpectrum.html">MCSpectrum</a> {
00097 
00098  <span class="keyword">public</span>:
00099 
00100     <a class="code" href="classMCSpectrum.html#a0">MCSpectrum</a>( <a class="code" href="classRunInfo.html">RunInfo</a> &amp;ri );
00101     ~<a class="code" href="classMCSpectrum.html">MCSpectrum</a>();
00102     
00103     <span class="keywordtype">void</span>   <a class="code" href="classMCSpectrum.html#a2">fill</a>(<span class="keywordtype">double</span> N0,  <span class="keywordtype">double</span> Gamma0, <span class="keywordtype">double</span> E0,  <span class="keywordtype">double</span> Time);
00104 
00105     <span class="comment">// uses class-histogram _spectrum and pointer to the experimental data</span>
00106     <span class="comment">// to determine chi-square value</span>
00107     <span class="keywordtype">double</span> <a class="code" href="classMCSpectrum.html#a3">chiSquare</a>(std::vector&lt;Data&gt; &amp;);
00108     
00109     <span class="keyword">inline</span> <span class="keywordtype">int</span>    <a class="code" href="classMCSpectrum.html#a4">dof</a>();
00110     
00111     <span class="keywordtype">double</span> <a class="code" href="classMCSpectrum.html#a5">get</a>(<span class="keywordtype">int</span>);
00112     <span class="keywordtype">void</span>   <a class="code" href="classMCSpectrum.html#a6">getRange</a>( <span class="keywordtype">int</span> bin, <span class="keywordtype">double</span> &amp;lower, <span class="keywordtype">double</span> &amp;upper );
00113     
00114     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> NUMMCBINS=9;
00115 
00116     <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* getSpectrum() { <span class="keywordflow">return</span> _spectrum; }
00117 
00118  <span class="keyword">private</span>:
00119 
00120     <span class="keywordtype">double</span> weight( <span class="keywordtype">double</span> energy,  <span class="keywordtype">double</span> N0, 
00121                    <span class="keywordtype">double</span> Gamma0, <span class="keywordtype">double</span> E0, <span class="keywordtype">double</span> time);
00122     
00123     <span class="keywordtype">void</span>   info  ( <span class="keywordtype">double</span> energy,
00124                   <span class="keywordtype">double</span> &amp;numShower, <span class="keywordtype">double</span> &amp;de, <span class="keywordtype">double</span> &amp;a, 
00125                   <span class="keywordtype">double</span> &amp;e1, <span class="keywordtype">double</span> &amp;e2);
00126     
00127 
00128     std::vector&lt;MCRecord&gt; _event;
00129 
00130     <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* _spectrum;     <span class="comment">//  histogram that holds</span>
00131                                    <span class="comment">// "artificial" energy spectrum</span>
00132 
00133     
00134     std::string _dbfilename;
00135     
00136     <span class="comment">// Class-variable holding the degrees of freedom of the fit</span>
00137     <span class="comment">// (depends on # of bins, and on event statistics)</span>
00138     <span class="keywordtype">int</span> _ndof;
00139 
00140     std::vector&lt;MCBinInfo&gt; _info;
00141 
00142 };   
00143 
00148 <span class="keywordtype">int</span> 
<a name="l00149"></a><a class="code" href="classMCSpectrum.html#a4">00149</a> <a class="code" href="classMCSpectrum.html#a4">MCSpectrum::dof</a>() {
00150     <span class="keywordflow">return</span> _ndof;
00151 }
00152 
00156 <span class="keyword">inline</span> <span class="keywordtype">double</span> 
<a name="l00157"></a><a class="code" href="classMCSpectrum.html#a5">00157</a> <a class="code" href="classMCSpectrum.html#a5">MCSpectrum::get</a>(<span class="keywordtype">int</span> i) {
00158     <span class="keywordflow">return</span> _spectrum-&gt;<a class="code" href="classHistogram.html#a21">get</a>(i);
00159 }
00160 
00164 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00165"></a><a class="code" href="classMCSpectrum.html#a6">00165</a> <a class="code" href="classMCSpectrum.html#a6">MCSpectrum::getRange</a>( <span class="keywordtype">int</span> bin, <span class="keywordtype">double</span> &amp;lower, <span class="keywordtype">double</span> &amp;upper ) {
00166   _spectrum-&gt;<a class="code" href="classHistogram.html#a9">getRange</a>(bin,lower,upper);
00167 }
00168 
<a name="l00172"></a><a class="code" href="classFitter.html">00172</a> <span class="keyword">class </span><a class="code" href="classFitter.html">Fitter</a> {
00173 
00174  <span class="keyword">public</span>:
00175     <a class="code" href="classFitter.html">Fitter</a>( <a class="code" href="classRunInfo.html">RunInfo</a> &amp;ri ){
00176 
00177         _mcSpectrum = <span class="keyword">new</span> <a class="code" href="classMCSpectrum.html">MCSpectrum</a>( ri );
00178 
00179     }
00180     ~<a class="code" href="classFitter.html">Fitter</a>(){;}
00181     
00182     <span class="comment">//</span>
00183     <span class="comment">// Start Actual Fitting Process</span>
00184     <span class="comment">// Save Chi-Square Table in File "Totals/chi.text"</span>
00185     <span class="comment">//</span>
00186     <span class="keywordtype">void</span> <a class="code" href="classFitter.html#a2">minimize</a>(<a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* energy_on,
00187                   <a class="code" href="classEnergySpectrum.html">EnergySpectrum</a>* energy_off, 
00188                   <span class="keywordtype">double</span> &amp;N0, <span class="keywordtype">double</span> &amp;Gamma0, <span class="keywordtype">double</span> &amp;e0, <span class="keywordtype">double</span> Time, 
00189                   <span class="keywordtype">double</span> n0Range, <span class="keywordtype">int</span> n0Step, 
00190                   <span class="keywordtype">double</span> gRange, <span class="keywordtype">int</span> gStep,<span class="keywordtype">double</span> onoffratio);
00191     
00192     <span class="comment">//</span>
00193     <span class="comment">// Print Out Results and Save Reconstructed Energy Spectra in</span>
00194     <span class="comment">// "Totals/espectrum.text"</span>
00195     <span class="comment">//</span>
00196     <span class="keywordtype">void</span>   <a class="code" href="classFitter.html#a3">save</a>();
00197     
00198  <span class="keyword">private</span>:
00199     <span class="comment">// Object that takes care of the MC data</span>
00200     <a class="code" href="classMCSpectrum.html">MCSpectrum</a> *_mcSpectrum;
00201     
00202     <span class="comment">// Array with experimental data</span>
00203     std::vector&lt;Data&gt;  _data;
00204     
00205     <span class="comment">// Results of chi-square fit</span>
00206     <a class="code" href="structResults.html">Results</a>    _results;
00207 };
00208 
00209 <span class="preprocessor">#endif</span>
00210 <span class="preprocessor"></span>    
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Apr 21 10:22:45 2007 for wuparam by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
