<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wuparam: PlotMaker.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>PlotMaker.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef PLOTMAKER_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define PLOTMAKER_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;plot.h&gt;</span>
00005 <span class="preprocessor">#include "Image2D.h"</span>
00006 <span class="preprocessor">#include "Exceptions.h"</span>
00007 <span class="preprocessor">#include "Camera.h"</span>
00008 <span class="preprocessor">#include "Types.h"</span>
00009 <span class="preprocessor">#include &lt;stack&gt;</span>
00010 
00011 <span class="keyword">struct </span><a class="code" href="structPedestal.html">Pedestal</a>;
00012 <span class="keyword">struct </span><a class="code" href="structHillasParameterization.html">HillasParameterization</a>;
00013 <span class="keyword">struct </span><a class="code" href="structMuonParameterization.html">MuonParameterization</a>;
00014 <span class="keyword">class </span><a class="code" href="classStar.html">Star</a>;
00015 
<a name="l00019"></a><a class="code" href="classPlotMaker.html">00019</a> <span class="keyword">class </span><a class="code" href="classPlotMaker.html">PlotMaker</a> {
00020 
00021  <span class="keyword">public</span>:
00022 
00023     <a class="code" href="classPlotMaker.html">PlotMaker</a>( std::string type, std::string filename=<span class="stringliteral">""</span>, 
00024                <span class="keywordtype">double</span> minx=-3.1,<span class="keywordtype">double</span> miny=-3.1, 
00025                <span class="keywordtype">double</span> maxx=3.1, <span class="keywordtype">double</span> maxy=3.1);
00026     ~<a class="code" href="classPlotMaker.html">PlotMaker</a>() {
00027         pl_closepl_r( plotter );
00028         pl_deletepl_r( plotter );
00029         fclose(_fp);
00030     }
00031 
00032     <span class="keyword">enum</span> ColorMap {
00033         COLORMAP_BLUES,
00034         COLORMAP_REDBLUE,
00035         COLORMAP_YELLOWGREEN,
00036         COLORMAP_INVERSEGREY,
00037         COLORMAP_GREY,
00038         COLORMAP_RAINBOW,
00039         COLORMAP_HOT,
00040         COLORMAP_PRINTABLE,
00041     };
00042 
00043     <span class="keyword">enum</span> ContourLineStyle {
00044         LINE_SOLID,
00045         LINE_DOTTED,
00046         LINE_DASHED
00047     };
00048 
00049     <span class="keyword">enum</span> CameraPlotType {
00050         CAMERA_IMAGE,
00051         CAMERA_PEDS,
00052         CAMERA_PEDDISPS,
00053         CAMERA_TUBENUMS
00054     };
00055 
00056     <span class="keywordtype">void</span> setAxisBox( <span class="keywordtype">double</span> minx, <span class="keywordtype">double</span> miny, <span class="keywordtype">double</span> maxx, <span class="keywordtype">double</span> maxy ) {
00057         _minx=minx; 
00058         _maxx=maxx; 
00059         _miny=miny; 
00060         _maxy=maxy;
00061     }
00062 
00063     <span class="keywordtype">void</span> setAxisBox( <a class="code" href="classImage2D.html">Image2D</a> &amp;im2d ) {
00064         setAxisBox( im2d.<a class="code" href="classImage2D.html#a4">getMinX</a>(),
00065                         im2d.<a class="code" href="classImage2D.html#a5">getMinY</a>(),
00066                         im2d.<a class="code" href="classImage2D.html#a6">getMaxX</a>(),
00067                         im2d.<a class="code" href="classImage2D.html#a7">getMaxY</a>() );
00068     }
00069 
00070     <span class="keywordtype">void</span> setAxisBox( <a class="code" href="classCamera.html">Camera</a> &amp;cam ) {
00071         setAxisBox( cam.<a class="code" href="classCamera.html#a16">getMinX</a>(),
00072                     cam.<a class="code" href="classCamera.html#a17">getMinY</a>(),
00073                     cam.<a class="code" href="classCamera.html#a18">getMaxX</a>(),
00074                     cam.<a class="code" href="classCamera.html#a19">getMaxY</a>() );
00075     }
00076 
00077     <span class="keywordtype">void</span> setSpace( <span class="keywordtype">double</span> minx, <span class="keywordtype">double</span> miny, <span class="keywordtype">double</span> maxx, <span class="keywordtype">double</span> maxy ){
00078         _pageminx = minx;
00079         _pageminy = miny;
00080         _pagemaxx = maxx;
00081         _pagemaxy = maxy;
00082         pl_fspace_r( plotter, _pageminx, _pageminy, _pagemaxx, _pagemaxy); 
00083     }
00084 
00085     <span class="keywordtype">void</span> flush() { pl_flushpl_r( plotter ); }
00086     <span class="keywordtype">void</span> newPage(){ pl_erase_r( plotter ); }
00087     <span class="keywordtype">void</span> pushState();
00088     <span class="keywordtype">void</span> popState();
00089 
00090     <span class="keywordtype">void</span> rotate( <span class="keywordtype">double</span> theta );
00091     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a11">plotAxes</a>();
00092     <span class="keywordtype">void</span> plotTitle( std::string title );
00093     <span class="keywordtype">void</span> plotSubtitle( std::string title );
00094     <span class="keywordtype">void</span> plotXTicAt( <span class="keywordtype">double</span> x );
00095     <span class="keywordtype">void</span> plotYTicAt( <span class="keywordtype">double</span> y );
00096     <span class="keywordtype">void</span> plotXMinorTicAt( <span class="keywordtype">double</span> x );
00097     <span class="keywordtype">void</span> plotYMinorTicAt( <span class="keywordtype">double</span> y );
00098     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a18">contourPlot</a>( <a class="code" href="classImage2D.html">Image2D</a> &amp;im2d, <span class="keywordtype">double</span> zmin, <span class="keywordtype">double</span> zmax, <span class="keywordtype">double</span> dz );
00099     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a19">plotRADecGrid</a>( <a class="code" href="classImage2D.html">Image2D</a> &amp;ragrid, <a class="code" href="classImage2D.html">Image2D</a> &amp;decgrid );
00100 
00101     <span class="comment">// Higher-level plot commands:</span>
00102     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="classImage2D.html">Image2D</a> &amp;im2d );
00103     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="classCamera.html">Camera</a> &amp;cam, <span class="keyword">const</span> Array_t &amp;image, <span class="keyword">const</span> vector&lt;Pedestal&gt; &amp;peds,
00104                vector&lt;int&gt; &amp;cleanpixels, CameraPlotType plottype=CAMERA_IMAGE);
00105     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="structHillasParameterization.html">HillasParameterization</a> &amp;p );
00106     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="structMuonParameterization.html">MuonParameterization</a> &amp;p );
00107     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="classStar.html">Star</a> &amp;s, <span class="keywordtype">int</span> symbol=16 );
00108     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( vector&lt;double&gt; &amp;xpoints, vector&lt;double&gt; &amp;ypoints );
00109     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( string text, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y  );
00110     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a25">plot</a>( <a class="code" href="classTelescopeArray.html">TelescopeArray</a> &amp;array );
00111     
00112     <span class="comment">// Lower-level plot commands</span>
00113     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a28">plotEllipse</a>( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> r1, <span class="keywordtype">double</span> r2,<span class="keywordtype">double</span> theta=0);
00114     <span class="keywordtype">void</span> plotMarker( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y );
00115 
00116     <span class="keywordtype">void</span> setColorMap( ColorMap c ) {_state.top().colormap = c; }
00117     <span class="keywordtype">void</span> setColorMap( string name ) {
00118         <span class="keywordflow">if</span>      (name == <span class="stringliteral">"blues"</span>)_state.top().colormap = COLORMAP_BLUES;
00119         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"redblue"</span>)_state.top().colormap = COLORMAP_REDBLUE;
00120         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"yellowgreen"</span>)_state.top().colormap = COLORMAP_YELLOWGREEN;
00121         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"inversegrey"</span>)_state.top().colormap = COLORMAP_INVERSEGREY;
00122         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"grey"</span>)_state.top().colormap = COLORMAP_GREY;
00123         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"rainbow"</span>)_state.top().colormap = COLORMAP_RAINBOW;
00124         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"hot"</span>)_state.top().colormap = COLORMAP_HOT;
00125         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">"printable"</span>)_state.top().colormap = COLORMAP_PRINTABLE;
00126         <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classMildAnalysisException.html">MildAnalysisException</a>(<span class="stringliteral">"unknown colormap "</span>+name);
00127     }
00128 
00129     <span class="keywordtype">void</span> <a class="code" href="classPlotMaker.html#a32">getMappedColor</a>(<span class="keywordtype">double</span> value, <span class="keywordtype">int</span> &amp;red, <span class="keywordtype">int</span> &amp;green, <span class="keywordtype">int</span> &amp;blue);
00130 
00131     <span class="keywordtype">void</span> setPixelScale( <span class="keywordtype">double</span> pixscale ) {_pixelscale = pixscale;}
00132     <span class="keywordtype">void</span> setScaleFactor( <span class="keywordtype">double</span> factor ) {_scalefactor = factor; }
00133     <span class="keywordtype">void</span> setTicLevel( <span class="keywordtype">int</span> l ) { _ticlevel = l; }
00134 
00135     <span class="keywordtype">void</span> setColorScale( <span class="keywordtype">double</span> lower, <span class="keywordtype">double</span> upper) {
00136         <span class="keywordflow">if</span> (lower&lt;=upper) {
00137             _state.top().colorscale_lower=lower;
00138             _state.top().colorscale_upper=upper;
00139         }
00140     }
00141     <span class="keywordtype">void</span> enableAutoScale( <span class="keywordtype">bool</span> val=<span class="keyword">true</span>) { _state.top().autoscale=val;  }
00142     <span class="keywordtype">void</span> setContourColorName( string name ) {
00143         _state.top().contourcolor = name;
00144     }
00145     <span class="keywordtype">void</span> setTicMarkColorName( string name ) {
00146         _state.top().ticcolor = name;
00147     }
00148     <span class="keywordtype">void</span> setContourLineStyle( ContourLineStyle i ){
00149         _state.top().contourlinestyle = i;
00150     }
00151     <span class="keywordtype">void</span> setContourLineStyle( string style ){
00152         <span class="keywordflow">if</span> (style == <span class="stringliteral">"solid"</span>) setContourLineStyle(LINE_SOLID);
00153         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (style == <span class="stringliteral">"dotted"</span>) setContourLineStyle(LINE_DOTTED);
00154         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (style == <span class="stringliteral">"dashed"</span>) setContourLineStyle(LINE_DASHED);
00155         <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classMildAnalysisException.html">MildAnalysisException</a>(<span class="stringliteral">"unknown line style "</span>+style);
00156     }
00157     
00158     <span class="keywordtype">void</span> setContourLineWidth( <span class="keywordtype">double</span> width ) {_state.top().contourwidth=width;}
00159     <span class="keywordtype">void</span> setLabelColorName( string name ) {_state.top().labelcolor = name; }
00160     <span class="keywordtype">void</span> setLabelAngle( <span class="keywordtype">double</span> theta ){_state.top().labelangle=theta;}
00161     <span class="keywordtype">void</span> setLabelSize( <span class="keywordtype">double</span> size ){_state.top().labelsize=size; }
00162     <span class="keywordtype">void</span> setMarkerType( <span class="keywordtype">int</span> type ) {_state.top().markertype = type; }
00163     <span class="keywordtype">void</span> setMarkerSize( <span class="keywordtype">double</span> size ) {_state.top().markersize = size; }
00164     <span class="keywordtype">void</span> setMarkerColorName( string name ) {_state.top().markercolor = name; }
00165     
00166 
00167 
00168  <span class="keyword">private</span>:
00169 
00170     <span class="keywordtype">void</span> setLineMod();
00171     <span class="keywordtype">void</span> niceRaDecContours(<span class="keywordtype">double</span> ra,  <span class="keywordtype">double</span> dec, 
00172                   <span class="keywordtype">double</span> xcont[],<span class="keywordtype">double</span> ycont[], 
00173                   <span class="keywordtype">double</span> ra_nice[], <span class="keywordtype">double</span> dec_nice[], 
00174                   <span class="keywordtype">int</span> drawx[], <span class="keywordtype">int</span> drawy[], 
00175                   <span class="keywordtype">char</span> ra_str[17][128],
00176                            <span class="keywordtype">char</span> dec_str[17][128]);
00177 
00178     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> NCONTSTEPS =17;
00179     
00180     plPlotter *plotter;
00181     plPlotterParams *plotter_params;
00182     FILE *_fp;
00183 
00184     <span class="keywordtype">double</span> _pageminx,_pageminy, _pagemaxx, _pagemaxy;
00185     <span class="keywordtype">double</span> _minx,_miny,_maxx,_maxy;
00186     <span class="keywordtype">double</span>  _pixelscale;
00187     <span class="keywordtype">double</span>  _maxmagnitude;
00188     <span class="keywordtype">int</span>     _numkeycolors;
00189     <span class="keywordtype">double</span>  _keyoffset;
00190     <span class="keywordtype">double</span>  _keywidth;
00191     <span class="keywordtype">double</span>  _labeloffset;
00192     <span class="keywordtype">double</span>  _titleoffset;
00193     <span class="keywordtype">double</span>  _subtitleoffset;
00194     <span class="keywordtype">int</span>     _ticlevel;
00195     <span class="keywordtype">double</span>  _ticmarksize;
00196     <span class="keywordtype">double</span>  _scalefactor;
00197 
00198     <span class="keyword">struct </span>PlotState {
00199 
00200         <span class="keywordtype">int</span>     contourlinestyle;
00201         <span class="keywordtype">int</span>     markertype;
00202         <span class="keywordtype">double</span>  markersize;
00203         string  markercolor;
00204         <span class="keywordtype">bool</span>    use_inward_tics;
00205         ColorMap colormap;
00206         string  contourcolor;
00207         <span class="keywordtype">double</span>  contourwidth;
00208         string  ticcolor;
00209         string  labelcolor;
00210         <span class="keywordtype">double</span>  labelangle;
00211         <span class="keywordtype">double</span>  labelsize;
00212         <span class="keywordtype">bool</span>    autoscale;
00213         <span class="keywordtype">double</span>  colorscale_lower;
00214         <span class="keywordtype">double</span>  colorscale_upper;
00215 
00216     };
00217 
00218     std::stack&lt;PlotState&gt; _state;
00219 
00220     <span class="keywordtype">double</span> xIntercept(<span class="keywordtype">double</span> , <span class="keywordtype">double</span> , <span class="keywordtype">double</span> , <span class="keywordtype">double</span> ,<span class="keywordtype">double</span> , <span class="keywordtype">double</span> );
00221     <span class="keywordtype">double</span> yIntercept(<span class="keywordtype">double</span> , <span class="keywordtype">double</span> , <span class="keywordtype">double</span> , <span class="keywordtype">double</span> ,<span class="keywordtype">double</span> , <span class="keywordtype">double</span> );
00222 
00223 };
00224 
00225 
00226 <span class="keyword">struct </span>ContourSegment {
00227     <a class="code" href="structCoordinate__t.html">Coordinate_t</a> start;
00228     <a class="code" href="structCoordinate__t.html">Coordinate_t</a> end;
00229 };
00230 
00231 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Apr 21 10:22:46 2007 for wuparam by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
