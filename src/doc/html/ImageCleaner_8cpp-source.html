<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>wuparam: ImageCleaner.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ImageCleaner.cpp</h1><div class="fragment"><pre>00001 
00002 <span class="preprocessor">#include "ImageCleaner.h"</span>
00003 <span class="preprocessor">#include "Camera.h"</span>
00004 <span class="preprocessor">#include "PedestalFinder.h"</span>
00005 <span class="preprocessor">#include &lt;vector&gt;</span>
00006 <span class="preprocessor">#include &lt;iostream&gt;</span>
00007 
00008 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00009 
00024 <a class="code" href="classDefaultImageCleaner.html#a0">DefaultImageCleaner::</a>
<a name="l00025"></a><a class="code" href="classDefaultImageCleaner.html#a0">00025</a> <a class="code" href="classDefaultImageCleaner.html#a0">DefaultImageCleaner</a>(<a class="code" href="classCamera.html">Camera</a> &amp;camera, vector&lt;Pedestal&gt; &amp;peds, 
00026                     <span class="keywordtype">double</span> picture,<span class="keywordtype">double</span> boundary) 
00027     : <a class="code" href="classImageCleaner.html">ImageCleaner</a>(camera),_picture_thresh(picture),_boundary_thresh(boundary)
00028 {
00029     
00030     _peds = &amp;peds;
00031     _cleanpixels.reserve(500); <span class="comment">// minimize resizing of cleanpixels</span>
00032 
00033 }
00034 
00035 
00036 vector&lt;int&gt;&amp; 
00037 DefaultImageCleaner::
00038 getCleanPixels( <span class="keyword">const</span> Array_t &amp;image ) {
00039     
00040     list&lt;int&gt; *neighs;
00041     list&lt;int&gt;::iterator iter;
00042     valarray&lt;bool&gt; picture(image.size());
00043     vector&lt;Pedestal&gt; &amp;peds = *_peds;
00044 
00045     <span class="keywordtype">int</span> i;
00046 
00047     _cleanpixels.clear();
00048 
00049     <span class="keywordflow">for</span> (i=0; i&lt;(<span class="keywordtype">int</span>)picture.size(); i++) {
00050         picture[i] = <span class="keyword">false</span>;
00051     }
00052 
00053     <span class="comment">// Put the "picture" tubes into the list...</span>
00054 
00055     <span class="keywordflow">for</span> (i=_cam-&gt;<a class="code" href="classCamera.html#a10">getFirstPixel</a>(); i&lt;_cam-&gt;<a class="code" href="classCamera.html#a11">getLastPixel</a>(); i++) {
00056         
00057         <span class="keywordflow">if</span> ( peds[i].type == Pedestal::GOOD &amp;&amp;
00058             image[i] &gt; _picture_thresh*peds[i].dispersion  ){ 
00059 
00060             picture[i] = <span class="keyword">true</span>;
00061             _cleanpixels.push_back(i);
00062         }
00063 
00064     }
00065 
00066     <span class="comment">// The "boundary" tubes must be over the boundary threshold and</span>
00067     <span class="comment">// have a picture tube as a neighbor</span>
00068     
00069     <span class="keywordflow">for</span> (i=_cam-&gt;<a class="code" href="classCamera.html#a10">getFirstPixel</a>(); i&lt;_cam-&gt;<a class="code" href="classCamera.html#a11">getLastPixel</a>(); i++) {
00070 
00071         <span class="keywordflow">if</span> (picture[i] == <span class="keyword">false</span>) {
00072             <span class="keywordflow">if</span> ( (image[i] &gt; _boundary_thresh*peds[i].dispersion)
00073                  &amp;&amp; peds[i].type == Pedestal::GOOD  ) {
00074                 
00075                 neighs = _cam-&gt;<a class="code" href="classCamera.html#a20">getNeighborListOfPixel</a>( i );
00076 
00077                 <span class="keywordflow">for</span> (iter=neighs-&gt;begin(); iter != neighs-&gt;end(); iter++) {
00078                     <span class="keywordflow">if</span> (picture[*iter]) {
00079                         
00080                         <span class="comment">// this tube passes, so add it to the list</span>
00081                         _cleanpixels.push_back(i);
00082                         <span class="keywordflow">break</span>;
00083 
00084                     }
00085                 }
00086             }
00087         }
00088     }
00089 
00090     <span class="keywordflow">return</span> _cleanpixels;
00091 
00092 }
00093 
00094 
00095 
00096 
00097 vector&lt;int&gt;&amp; 
00098 ThresholdImageCleaner::
00099 getCleanPixels( <span class="keyword">const</span> Array_t &amp;image ) {
00100 
00101 
00102     _cleanpixels.clear();
00103     
00104     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=_cam-&gt;<a class="code" href="classCamera.html#a10">getFirstPixel</a>(); i&lt;_cam-&gt;<a class="code" href="classCamera.html#a11">getLastPixel</a>(); i++) {
00105         <span class="keywordflow">if</span> ( image[i] &gt; _threshold ) 
00106             _cleanpixels.push_back(i);
00107     }
00108     
00109     <span class="keywordflow">return</span> _cleanpixels;
00110     
00111 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Apr 21 10:22:45 2007 for wuparam by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
